<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Thought Reframer</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f9;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.card {
  background: white;
  padding: 20px;
  border-radius: 12px;
  width: 400px;
  box-shadow: 0 10px 20px rgba(0,0,0,0.1);
}
textarea, input {
  width: 100%;
  margin-top: 10px;
  padding: 8px;
}
button {
  margin-top: 10px;
  padding: 10px;
  width: 100%;
}
.output {
  margin-top: 15px;
  font-weight: bold;
}
.status {
  font-size: 12px;
  color: gray;
}
</style>
</head>
<body>

<div class="card">
  <h2>Reframe a Thought</h2>

  <textarea id="input" placeholder="Type a negative thought..."></textarea>
  <button onclick="reframe()">Make it Positive</button>
  <div class="output" id="output"></div>

  <hr>

  <h3>Add a word pair</h3>
  <input id="newPair" placeholder="ugly = beautiful">
  <button onclick="addPair()">Add to Word List</button>
  <button onclick="sendToGoogleForm()">Send Suggestion to Developer</button>
  <div class="status" id="status"></div>
</div>

<script>

// Load saved replacements or default ones
let replacements = JSON.parse(localStorage.getItem("replacements")) || [
  ["can't", "can"],
  ["doesn't", "does"],
  ["failure", "success"],
  ["don't", "do"],
  ["isn't", "is"],
  ["bad", "good"],
  ["hate", "love"],
  ["I'll never", "I will"],
  ["I'm terrible", "I'm good"],
  ["I'm not", "I am"],
  ["doomed", "safe"],
  ["waste", "success"],
  ["wrong", "right"]
];

function escapeRegExp(str) {
  return str.replace(/[.*+?^${}()|[\\]\\]/g, "\\$&");
}

function reframe() {
  let text = document.getElementById("input").value;
  let result = text;

  // longest phrases first
  replacements.sort((a, b) => b[0].length - a[0].length);

  replacements.forEach(pair => {
    let regex = new RegExp(escapeRegExp(pair[0]), "gi");
    result = result.replace(regex, pair[1]);
  });

  document.getElementById("output").innerText = result;
}

function addPair() {
  let pairText = document.getElementById("newPair").value;

  if (!pairText.includes("=")) {
    document.getElementById("status").innerText =
      "Use format: ugly = beautiful";
    return;
  }

  let [bad, good] = pairText.split("=").map(x => x.trim());

  replacements.push([bad, good]);
  localStorage.setItem("replacements", JSON.stringify(replacements));

  document.getElementById("status").innerText =
    `Added "${bad} → ${good}"`;

  document.getElementById("newPair").value = "";
}

// ⭐ GOOGLE FORM SUBMITTER
function sendToGoogleForm() {
  let pairText = document.getElementById("newPair").value;

  if (!pairText) {
    document.getElementById("status").innerText = "Enter a pair first";
    return;
  }

  let formURL = "https://docs.google.com/forms/d/e/1FAIpQLSelwz1FqlQDKF7fACwpeLqhxNU7d3ZDvJMkvtO03S1sBCnlXg/formResponse";
  let entryID = "entry.1092775384";

  fetch(formURL, {
    method: "POST",
    mode: "no-cors",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: entryID + "=" + encodeURIComponent(pairText)
  });

  document.getElementById("status").innerText = "Suggestion sent to developer ✔";
  document.getElementById("newPair").value = "";
}

</script>

</body>
</html>
